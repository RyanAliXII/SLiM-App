{{define "printables-generator/books/index"}}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0" /> -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
      rel="stylesheet"
    />
    <title>{{.book.Id}}</title>
  </head>
  <style>
    div {
      page-break-inside: avoid;
    }
    .catalog-card {
      min-height: 3in;
      width: 5in;
      border: 1px dotted black;
      margin: 10px auto;
      font-family: "Roboto", sans-serif;
    }
    .roboto {
      font-family: "Roboto", sans-serif;
    }
    .ddc-cutter {
      padding: 25px;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }
    .author-list {
      max-width: 280px;
    }
    .card-content-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .card-content {
      width: fit-content;
    }
    .main-text {
      font-size: medium;
    }
    .text {
      font-size: smaller;
      word-spacing: 2px;
    }
    .text-small {
      font-size: x-small;
    }
    .call-numbers {
      width: 3in;
      width: 5in;
      display: grid;
      grid-template-columns: auto auto;
      gap: 15px;
      margin: auto;
    }
    .call-number {
      width: 80px;
      height: 115px;
      padding: 10px;
      border: 1px dotted black;
    }
    .item {
      display: flex;
      gap: 5px;
      align-items: center;
    }
  </style>
  <body>
    <div class="catalog-cards">
      <div class="title-cards">
        <h3 class="roboto" style="text-align: center">Title card</h3>
        {{range $accession := .book.Accessions}}
        <div class="catalog-card">
          <div class="ddc-cutter text">
            <small>{{$.book.DDC}}</small><small>{{$.book.AuthorNumber}}</small>
            <span></span>
          </div>
          <div class="card-content-wrapper">
            <div class="card-content">
              <span class="main-text">{{$.book.Title}}</span>
              <div class="author-list" style="margin-top: 2px">
                {{range $idx, $author := $.authors}} {{if eq (add $idx 1) (len
                $.authors)}}
                <span class="text">{{$author}}</span>
                {{else}}
                <span class="text">{{$author}},</span>
                {{end}} {{end}} {{if ne $.book.Edition 0 }}
                <span class="text"> -- {{ ordinal $.book.Edition }} ed.</span>
                {{end}}
              </div>

              <div class="text" style="margin-top: 2px">
                <span>{{$.book.Publisher.Name}}, {{$.book.YearPublished}}</span>
              </div>
              <div class="text-small" style="margin-top: 4px">
                <span>{{$.book.Pages}} p.</span>
              </div>
              <div class="text-small" style="margin-top: 2px">
                <span>ISBN : {{$.book.ISBN}}</span>
              </div>
            </div>
          </div>
        </div>
        {{end}}
      </div>
      <div class="author-cards">
        <h3 class="roboto" style="text-align: center">Author card</h3>
        {{range $accession := .book.Accessions}}
        <div class="catalog-card">
          <div class="ddc-cutter text">
            <small>{{$.book.DDC}}</small><small>{{$.book.AuthorNumber}}</small>
            <span></span>
          </div>
          <div class="card-content-wrapper">
            <div class="card-content">
              <div class="author-list" style="margin-top: 2px">
                {{range $idx, $author := $.authors}} {{if eq (add $idx 1) (len
                $.authors)}}
                <span class="main-text">{{$author}}</span>
                {{else}}
                <span class="main-text">{{$author}},</span>
                {{end}} {{end}}
              </div>
              <div class="text">
                <span class="text"> {{$.book.Title}} </span>

                {{if ne $.book.Edition 0 }}
                <span class="text"> -- {{ordinal $.book.Edition }} ed.</span>
                {{end}}
              </div>

              <div class="text" style="margin-top: 2px">
                <span>{{$.book.Publisher.Name}}, {{$.book.YearPublished}}</span>
              </div>
              <div class="text-small" style="margin-top: 4px">
                <span>{{$.book.Pages}} p.</span>
              </div>
              <div class="text-small" style="margin-top: 2px">
                <span>ISBN : {{$.book.ISBN}}</span>
              </div>
            </div>
          </div>
        </div>
        {{end}}
      </div>

      <div class="call-numbers roboto">
        {{range $accession := .book.Accessions}}
        <div class="item" id="{{$accession.Id}}">
          <div class="qr"></div>
          <div class="call-number">
            <div>
              <span class="main-text">{{$.book.Section.Prefix}}</span>
            </div>
            <div>
              <span class="text">{{firstchar $.book.Title}}{{$.book.DDC}}</span>
            </div>
            <div>
              <span class="text">{{$.book.AuthorNumber}}</span>
            </div>
            <div>
              <span class="text">{{$.book.YearPublished}}</span>
            </div>
            {{if gt (len $.book.Accessions) 1}}
            <div>
              <span class="text">c.{{$accession.CopyNumber}}</span>
            </div>
            {{end}}
          </div>
        </div>
        {{end}}
      </div>
    </div>
  </body>
  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
  <script>
    const qrArea = document.querySelector(".call-numbers");
    for (let i = 0; i < qrArea.children.length; i++) {
      const callNumberDiv = qrArea.children[i];
      const qrDiv = callNumberDiv.querySelector(".qr");
      new QRCode(qrDiv, {
        text: callNumberDiv.id,
        width: 80,
        height: 80,
      });
    }
  </script>
</html>

{{end}}
